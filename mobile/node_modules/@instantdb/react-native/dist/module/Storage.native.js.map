{"version":3,"file":"Storage.native.js","sourceRoot":"","sources":["../../src/Storage.native.ts"],"names":[],"mappings":"AAAA,OAAO,YAAY,MAAM,2CAA2C,CAAC;AACrE,OAAO,EAAE,cAAc,EAA2B,MAAM,iBAAiB,CAAC;AAE1E,MAAM,OAAO,GAAG,CAAC,CAAC;AAElB,MAAM,CAAC,OAAO,OAAO,KAAM,SAAQ,cAAc;IACvC,KAAK,CAAS;IACd,MAAM,CAA0B;IACxC,YAAY,KAAa,EAAE,MAA+B;QACxD,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QACrB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACvB,CAAC;IAEO,OAAO,CAAC,CAAS;QACvB,OAAO,WAAW,IAAI,CAAC,KAAK,IAAI,OAAO,IAAI,IAAI,CAAC,MAAM,IAAI,CAAC,EAAE,CAAC;IAChE,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,CAAC;QACb,MAAM,GAAG,GAAG,MAAM,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;QACxD,IAAI,GAAG,KAAK,IAAI;YAAE,OAAO,GAAG,CAAC;QAC7B,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzB,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC;QAChB,MAAM,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;IACjE,CAAC;IAED,KAAK,CAAC,UAAU,CAAC,CAAS;QACxB,MAAM,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;IACjD,CAAC;IAED,KAAK,CAAC,UAAU;QACd,MAAM,OAAO,GAAG,MAAM,YAAY,CAAC,UAAU,EAAE,CAAC;QAChD,MAAM,IAAI,GAAa,EAAE,CAAC;QAC1B,MAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACnC,KAAK,MAAM,GAAG,IAAI,OAAO,EAAE,CAAC;YAC1B,IAAI,GAAG,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE,CAAC;gBAC9B,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;YAC7C,CAAC;QACH,CAAC;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,aAAmC;QAChD,MAAM,YAAY,CAAC,QAAQ,CACzB,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CACpE,CAAC;IACJ,CAAC;CACF","sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage';\nimport { StoreInterface, StoreInterfaceStoreName } from '@instantdb/core';\n\nconst version = 5;\n\nexport default class Store extends StoreInterface {\n  private appId: string;\n  private dbName: StoreInterfaceStoreName;\n  constructor(appId: string, dbName: StoreInterfaceStoreName) {\n    super(appId, dbName);\n    this.appId = appId;\n    this.dbName = dbName;\n  }\n\n  private makeKey(k: string): string {\n    return `instant_${this.appId}_${version}_${this.dbName}_${k}`;\n  }\n\n  async getItem(k) {\n    const res = await AsyncStorage.getItem(this.makeKey(k));\n    if (res === null) return res;\n    return JSON.parse(res);\n  }\n\n  async setItem(k, v) {\n    await AsyncStorage.setItem(this.makeKey(k), JSON.stringify(v));\n  }\n\n  async removeItem(k: string): Promise<void> {\n    await AsyncStorage.removeItem(this.makeKey(k));\n  }\n\n  async getAllKeys(): Promise<string[]> {\n    const allKeys = await AsyncStorage.getAllKeys();\n    const keys: string[] = [];\n    const keyPrefix = this.makeKey('');\n    for (const key of allKeys) {\n      if (key.startsWith(keyPrefix)) {\n        keys.push(key.substring(keyPrefix.length));\n      }\n    }\n    return keys;\n  }\n\n  async multiSet(keyValuePairs: Array<[string, any]>): Promise<void> {\n    await AsyncStorage.multiSet(\n      keyValuePairs.map(([k, v]) => [this.makeKey(k), JSON.stringify(v)]),\n    );\n  }\n}\n"]}